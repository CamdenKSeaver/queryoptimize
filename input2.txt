-- Complex test with 6 tables - guarantees all steps show different trees
-- Schema Definitions
Customer(
  Cid, Cname, City, Age,
  PRIMARY KEY(Cid)
);

Orders(
  Oid, Odate, Cid, Total,
  PRIMARY KEY(Oid),
  UNIQUE(Odate)
);

Product(
  Pid, Pname, Price, Category,
  PRIMARY KEY(Pid),
  UNIQUE(Pname)
);

OrderLine(
  Oid, Pid, Quantity,
  PRIMARY KEY(Oid, Pid)
);

Supplier(
  Sid, Sname, Country,
  PRIMARY KEY(Sid)
);

Supply(
  Sid, Pid, Cost,
  PRIMARY KEY(Sid, Pid)
);

-- SQL Query with 6 tables, multiple join paths, range conditions, and OR
SELECT C.Cname, P.Pname, SUM(L.Quantity) AS TotalQty, AVG(O.Total) AS AvgTotal
FROM Customer C, Orders O, Product P, OrderLine L, Supplier S, Supply Sup
WHERE C.Cid = O.Cid
  AND O.Oid = L.Oid
  AND L.Pid = P.Pid
  AND P.Pid = Sup.Pid
  AND Sup.Sid = S.Sid
  AND P.Pname = 'Laptop'
  AND C.Age > 25
  AND C.Age <= 65
  AND O.Total >= 1000
  AND P.Price < 2000
  AND (S.Country = 'USA' OR S.Country = 'Canada')
  AND Sup.Cost <> 0
GROUP BY C.Cname, P.Pname
HAVING SUM(L.Quantity) > 10
ORDER BY TotalQty DESC;